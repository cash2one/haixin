/*! jiemian 2015-04-02 */
!function($){function init(a){$.extend(config,a),null!=config.expData&&(EXP_DATA=config.expData),_getImgData();var b=$(config.trigger);b.each(function(){$(this).on("click",function(){var a=$(this),b=$(a.parent().siblings(config.holder)[0]),c=$(b.find(config.textarea)[0]),d=$(_genrt_html()),e=a.offset(),f=e.left-50,g=e.top,h=a.width(),i=a.height(),j=g+i,k=f+(h+pos_correct_left)/2,l=d.find(exp_close_tri),m=d.find(".exp-sub-tab"),n=m.children(".group-name"),o=m.find(".pre"),p=m.find(".next"),q=null,r=EXP_DATA.length,s=function(){var a=Math.floor(r/config.grpNum);return r%config.grpNum!=0?a+1:a}(),t=1,u=d.find(".exp-detail"),v=function(a){var b,e="";if(null!=q&&q!=a){n.eq(q).removeClass("slct"),q=a,n.eq(a).addClass("slct"),n.eq(a).addClass("slct");for(var f=0;f<EXP_DATA[a].icons.length;f++)e+='<li action-data="['+EXP_DATA[a].icons[f].title+']"><img title="'+EXP_DATA[a].icons[f].title+'" alt="'+EXP_DATA[a].icons[f].title+'" src="'+EXP_DATA[a].icons[f].url+'"></li>';b=$(e),b.each(function(){$(this).click(function(){var a=$(this),b=a.attr("action-data"),e=c.val();c.val(e+b).change(),$(bd).off("click"),a.off("mouseout"),$(win).off("resize"),d.remove()})}),u.children().remove(),u.append(b)}else if(null==q){q=a,n.eq(a).addClass("slct");for(var f=0;f<EXP_DATA[a].icons.length;f++)e+='<li action-data="['+EXP_DATA[a].icons[f].title+']"><img title="'+EXP_DATA[a].icons[f].title+'" alt="'+EXP_DATA[a].icons[f].title+'" src="'+EXP_DATA[a].icons[f].url+'"></li>';b=$(e),b.each(function(){$(this).click(function(){var a=$(this),b=a.attr("action-data"),e=c.val();c.focus(),c.val(e+b).change(),$(bd).off("click"),a.off("mouseout"),$(win).off("resize"),d.remove()})}),u.children().remove(),u.append(b)}},w=function(a){var b={};b.left=(a-1)*config.grpNum,b.left=Math.max(0,b.left),b.right=a*config.grpNum-1,b.right=Math.min(b.right,r-1),n.hide();for(var c=b.left;c<=b.right;c++)n.eq(c).show();t=a,1==t?o.addClass("pre-disable"):o.removeClass("pre-disable"),t>=s?p.addClass("next-disalbe"):p.removeClass("next-disalbe")};"fixed"==config.posType&&(g=e.top-$(win).scrollTop(),j=g+i),expEnable&&(d.css({position:config.posType,zIndex:config.zIndex,left:k+"px",top:j+"px"}),$(win).resize(function(){e=a.offset(),f=e.left-50,g=e.top,j=g+i,k=f+(h+pos_correct_left)/2,d.css({left:k+"px",top:j+"px"})}),l.click(function(){$(bd).off("click"),a.off("mouseout"),$(win).off("resize"),d.remove()}),a.mouseout(function(){$(bd).click(function(b){var c=$(b.target),e=c.parents(".exp-layer");e.hasClass("exp-layer")||(d.remove(),$(bd).off("click"),a.off("mouseout"),$(win).off("resize"))})}),w(1),o.click(function(){var a=t-1;a=1>a?1:a,w(a)}),p.click(function(){var a=t+1;a=a>s?t:a,w(a)}),v(0),n.each(function(){$(this).click(function(){var a=$(this),b=a.attr("grp-index");v(b)})}),$("body").append(d),d.show())})})}function disableExp(){expEnable=!1}function enableExp(){expEnable=!0}function getRemoteNewExp(data_url){$.ajax({url:data_url,success:function(data){EXP_DATA=eval(data),_getImgData()},error:function(){}})}function textFormat(a){var b,c=/\[([^\]\[\/ ]+)\]/g,d=a;for(_getImgData();b=c.exec(d);){var e,f=_switchImg(b[1]),g="\\[("+b[1]+")\\]";e=new RegExp(g,"g"),d.match(b[0])&&f!=b[1]&&(d=d.replace(e,f))}return d}function _genrt_html(){var a='<div class="exp-layer"><div class="holder"><div class="content"><div class="exp-tab clearfix"><a href="javascript:;">表情</a></div><ul class="exp-detail clearfix"></ul></div><a class="exp-close" href="javascript:;"></a></div><a class="exp-tri" href="javascript:;"></a></div>';return a}function _switchImg(a){for(var b=0;b<IMGS_DATA.length;b++)if(IMGS_DATA[b].title==a)return'<img src="'+IMGS_DATA[b].url+'" width="20" height="20" class="emoji-img"/>';return a}function _getImgData(){for(var a=0;a<EXP_DATA.length;a++){IMGS_DATA.push(EXP_DATA[a].icons);for(var b=0;b<EXP_DATA[a].icons.length;b++)IMGS_DATA.push(EXP_DATA[a].icons[b])}}$.expBlock={};var IMG_DOMAIN="http://img.jiemian.com/static/jmw",EXP_DATA=[{name:"默认",icons:[{url:IMG_DOMAIN+"/plugins/bq/img/horse2_thumb.gif",title:"/神马"},{url:IMG_DOMAIN+"/plugins/bq/img/fuyun_thumb.gif",title:"/浮云"},{url:IMG_DOMAIN+"/plugins/bq/img/geili_thumb.gif",title:"/给力"},{url:IMG_DOMAIN+"/plugins/bq/img/wg_thumb.gif",title:"/围观"},{url:IMG_DOMAIN+"/plugins/bq/img/vw_thumb.gif",title:"/威武"},{url:IMG_DOMAIN+"/plugins/bq/img/otm_thumb.gif",title:"/奥特曼"},{url:IMG_DOMAIN+"/plugins/bq/img/j_thumb.gif",title:"/囧"},{url:IMG_DOMAIN+"/plugins/bq/img/hufen_thumb.gif",title:"/互粉"},{url:IMG_DOMAIN+"/plugins/bq/img/smilea_thumb.gif",title:"/呵呵"},{url:IMG_DOMAIN+"/plugins/bq/img/tootha_thumb.gif",title:"/嘻嘻"},{url:IMG_DOMAIN+"/plugins/bq/img/laugh.gif",title:"/哈哈"},{url:IMG_DOMAIN+"/plugins/bq/img/tza_thumb.gif",title:"/可爱"},{url:IMG_DOMAIN+"/plugins/bq/img/kl_thumb.gif",title:"/可怜"},{url:IMG_DOMAIN+"/plugins/bq/img/kbsa_thumb.gif",title:"/挖鼻屎"},{url:IMG_DOMAIN+"/plugins/bq/img/cj_thumb.gif",title:"/吃惊"},{url:IMG_DOMAIN+"/plugins/bq/img/shamea_thumb.gif",title:"/害羞"},{url:IMG_DOMAIN+"/plugins/bq/img/zy_thumb.gif",title:"/挤眼"},{url:IMG_DOMAIN+"/plugins/bq/img/bz_thumb.gif",title:"/闭嘴"},{url:IMG_DOMAIN+"/plugins/bq/img/bs2_thumb.gif",title:"/鄙视"},{url:IMG_DOMAIN+"/plugins/bq/img/sada_thumb.gif",title:"/泪"},{url:IMG_DOMAIN+"/plugins/bq/img/heia_thumb.gif",title:"/偷笑"},{url:IMG_DOMAIN+"/plugins/bq/img/sb_thumb.gif",title:"/生病"},{url:IMG_DOMAIN+"/plugins/bq/img/mb_thumb.gif",title:"/太开心"},{url:IMG_DOMAIN+"/plugins/bq/img/ldln_thumb.gif",title:"/懒得理你"},{url:IMG_DOMAIN+"/plugins/bq/img/yhh_thumb.gif",title:"/右哼哼"},{url:IMG_DOMAIN+"/plugins/bq/img/zhh_thumb.gif",title:"/左哼哼"},{url:IMG_DOMAIN+"/plugins/bq/img/x_thumb.gif",title:"/嘘"},{url:IMG_DOMAIN+"/plugins/bq/img/cry.gif",title:"/衰"},{url:IMG_DOMAIN+"/plugins/bq/img/wq_thumb.gif",title:"/委屈"},{url:IMG_DOMAIN+"/plugins/bq/img/t_thumb.gif",title:"/吐"},{url:IMG_DOMAIN+"/plugins/bq/img/k_thumb.gif",title:"/打哈气"},{url:IMG_DOMAIN+"/plugins/bq/img/bba_thumb.gif",title:"/抱抱"},{url:IMG_DOMAIN+"/plugins/bq/img/angrya_thumb.gif",title:"/怒"},{url:IMG_DOMAIN+"/plugins/bq/img/yw_thumb.gif",title:"/疑问"},{url:IMG_DOMAIN+"/plugins/bq/img/cza_thumb.gif",title:"/馋嘴"},{url:IMG_DOMAIN+"/plugins/bq/img/88_thumb.gif",title:"/拜拜"},{url:IMG_DOMAIN+"/plugins/bq/img/sk_thumb.gif",title:"/思考"},{url:IMG_DOMAIN+"/plugins/bq/img/sweata_thumb.gif",title:"/汗"},{url:IMG_DOMAIN+"/plugins/bq/img/sleepya_thumb.gif",title:"/困"},{url:IMG_DOMAIN+"/plugins/bq/img/sleepa_thumb.gif",title:"/睡觉"},{url:IMG_DOMAIN+"/plugins/bq/img/money_thumb.gif",title:"/钱"},{url:IMG_DOMAIN+"/plugins/bq/img/sw_thumb.gif",title:"/失望"},{url:IMG_DOMAIN+"/plugins/bq/img/cool_thumb.gif",title:"/酷"},{url:IMG_DOMAIN+"/plugins/bq/img/hatea_thumb.gif",title:"/哼"},{url:IMG_DOMAIN+"/plugins/bq/img/gza_thumb.gif",title:"/鼓掌"},{url:IMG_DOMAIN+"/plugins/bq/img/dizzya_thumb.gif",title:"/晕"},{url:IMG_DOMAIN+"/plugins/bq/img/bs_thumb.gif",title:"/悲伤"},{url:IMG_DOMAIN+"/plugins/bq/img/crazya_thumb.gif",title:"/抓狂"},{url:IMG_DOMAIN+"/plugins/bq/img/h_thumb.gif",title:"/黑线"},{url:IMG_DOMAIN+"/plugins/bq/img/yx_thumb.gif",title:"/阴险"},{url:IMG_DOMAIN+"/plugins/bq/img/nm_thumb.gif",title:"/怒骂"},{url:IMG_DOMAIN+"/plugins/bq/img/hearta_thumb.gif",title:"/心"},{url:IMG_DOMAIN+"/plugins/bq/img/unheart.gif",title:"/伤心"},{url:IMG_DOMAIN+"/plugins/bq/img/pig.gif",title:"/猪头"},{url:IMG_DOMAIN+"/plugins/bq/img/ok_thumb.gif",title:"/ok"},{url:IMG_DOMAIN+"/plugins/bq/img/ye_thumb.gif",title:"/耶"},{url:IMG_DOMAIN+"/plugins/bq/img/good_thumb.gif",title:"/赞"},{url:IMG_DOMAIN+"/plugins/bq/img/no_thumb.gif",title:"/不要"},{url:IMG_DOMAIN+"/plugins/bq/img/come_thumb.gif",title:"/来"},{url:IMG_DOMAIN+"/plugins/bq/img/sad_thumb.gif",title:"/弱"}]}],IMGS_DATA=[],expEnable=!0,config={expData:null,holder:".exp-holder",textarea:"textarea",trigger:".exp-block-trigger",grpNum:5,posType:"absolute",zIndex:"100"},pos_correct_left=30,exp_close_tri=".exp-close",grp_num_per_panel=1,win=window||document,bd="body";$.expBlock={initExp:init,disableExp:disableExp,enableExp:enableExp,getRemoteExp:getRemoteNewExp,textFormat:textFormat}}(jQuery);
/*! jiemian 最后修改于： 2015-04-02 */